generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               Int            @id @default(autoincrement())
  username         String         @unique @db.VarChar(50)
  password         String         @db.VarChar(255)
  name             String         @db.VarChar(100)
  email            String         @unique @db.VarChar(100)
  role             String?        @default("user") @db.VarChar(20)
  department       String?        @db.VarChar(100)
  position         String?        @db.VarChar(100)
  annualLeaveQuota Int?           @default(12) @map("annual_leave_quota")
  createdAt        DateTime?      @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime?      @default(now()) @map("updated_at") @db.Timestamp(6)
  approvedRequests LeaveRequest[] @relation("ApprovedLeaves")
  leaveRequests    LeaveRequest[] @relation("UserLeaves")

  @@map("users")
}

model LeaveRequest {
  id              Int       @id @default(autoincrement())
  userId          Int       @map("user_id")
  leaveType       String    @map("leave_type") @db.VarChar(20)
  startDate       DateTime  @map("start_date") @db.Date
  endDate         DateTime  @map("end_date") @db.Date
  days            Int
  reason          String
  status          String?   @default("pending") @db.VarChar(20)
  approvedBy      Int?      @map("approved_by")
  approvedAt      DateTime? @map("approved_at") @db.Timestamp(6)
  rejectionReason String?   @map("rejection_reason")
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt       DateTime? @default(now()) @map("updated_at") @db.Timestamp(6)
  approver        User?     @relation("ApprovedLeaves", fields: [approvedBy], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user            User      @relation("UserLeaves", fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("leave_requests")
}
